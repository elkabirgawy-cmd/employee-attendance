# ุฅุตูุงุญ ููุญุฉ ุงูุชุญูู: ุนุฑุถ ุญุงูุฉ ุงูููู (ููู ุนูู / ุฅุฌุงุฒุฉ)

## โ ุงููุดููุฉ ุงูุชู ุชู ุญููุง

**ูุจู**: ููุญุฉ ุงูุชุญูู ุชุนุฑุถ "ุงูุญุถูุฑ: 0" ู "ุงูุบูุงุจ: 0" ูู ุฃูุงู ุงูุฅุฌุงุฒุงุช ุจุฏูู ุชูุถูุญุ ููุง ูุณุจุจ ุงุฑุชุจุงู.

**ุจุนุฏ**: ุดุงุฑุฉ ูุงุถุญุฉ ุชุธูุฑ "ุงูููู ุฅุฌุงุฒุฉ" ุฃู "ููู ุนูู" ูุน ูุนุงูุฌุฉ ุชููุงุฆูุฉ ููุบูุงุจ ูู ุฃูุงู ุงูุฅุฌุงุฒุงุช.

---

## ๐ฏ ูุง ุชู ุชูููุฐู

### 1. ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุฌุฏูู ุฌุฏูุฏ: holidays (ุงูุนุทูุงุช)**
- ุชุฎุฒูู ุงูุนุทูุงุช ุงูุฑุณููุฉ ููู ุดุฑูุฉ
- ุนุฒู ุชุงู ุจูู ุงูุดุฑูุงุช
- ุฏุนู ุงูุนุทูุงุช ุงููุชูุฑุฑุฉ (ุฌุงูุฒ ูููุณุชูุจู)

**ุฏูุงู ุฌุฏูุฏุฉ**:
- โ `get_today_status()` - ุชุญุฏูุฏ ุญุงูุฉ ุงูููู (ุนูู/ุฅุฌุงุฒุฉ)
- โ `get_expected_employees_count()` - ุนุฏุฏ ุงูููุธููู ุงููุชููุนูู ุงูููู

**ุฏูุงู ูุญุฏุซุฉ**:
- โ `get_absent_today_count()` - ูุนูุฏ 0 ูู ุฃูุงู ุงูุฅุฌุงุฒุงุช
- โ `get_absent_employees_list()` - ูุนูุฏ ูุงุฆูุฉ ูุงุฑุบุฉ ูู ุฃูุงู ุงูุฅุฌุงุฒุงุช

### 2. ูุงุฌูุฉ ุงููุณุชุฎุฏู

**ููุญุฉ ุงูุชุญูู**:
- โ ุดุงุฑุฉ ููููุฉ ุชุนุฑุถ ุญุงูุฉ ุงูููู
- โ ูุนูููุงุช ุฅุถุงููุฉ ุนู ุณุจุจ ุงูุฅุฌุงุฒุฉ
- โ ุชุญุฏูุซ ุชููุงุฆู ูุจุทุงูุฉ ุงูุบูุงุจ

---

## ๐ ููุทู ุญุงูุฉ ุงูููู

### ุงูููู ูุนุชุจุฑ ุฅุฌุงุฒุฉ ุฅุฐุง:

1. **ุฅุฌุงุฒุฉ ุฃุณุจูุนูุฉ**: ุงูููู ุถูู ุฃูุงู ุงูุฅุฌุงุฒุฉ ุงูุฃุณุจูุนูุฉ ููุดุฑูุฉ
   - ูุซุงู: ุงูุฌูุนุฉ ูุงูุณุจุช

2. **ุนุทูุฉ ุฑุณููุฉ**: ุงูุชุงุฑูุฎ ูุทุงุจู ุนุทูุฉ ูู ุฌุฏูู ุงูุนุทูุงุช
   - ูุซุงู: ุฑุฃุณ ุงูุณูุฉุ ุงูุนูุฏ ุงููุทูู

### ุงูููู ูุนุชุจุฑ ููู ุนูู:

ูู ุงูุฃูุงู ุงูุฃุฎุฑู ุงูุชู ูุง ุชูุทุจู ุนูููุง ุงูุดุฑูุท ุฃุนูุงู.

### ุงูุณููู ูู ุฃูุงู ุงูุฅุฌุงุฒุฉ:

| ุงููููู | ุงูุณููู |
|--------|---------|
| ุนุฏุฏ ุงูุบูุงุจ | 0 |
| ูุงุฆูุฉ ุงูุบุงุฆุจูู | ูุงุฑุบุฉ |
| ุงูููุธููู ุงููุชููุนูู | 0 |
| ุดุงุฑุฉ ููุญุฉ ุงูุชุญูู | "ุงูููู ุฅุฌุงุฒุฉ" (ููุฑูุงูู) |
| ูุต ุจุทุงูุฉ ุงูุบูุงุจ | "ูุง ููุญุณุจ ุงูุบูุงุจ ูู ุงูุฅุฌุงุฒุงุช" |

---

## ๐จ ุงูุชุตููู

### ุงูุดุงุฑุฉ

**ููู ุนูู**:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ููุญุฉ ุงูุชุญูู [ููู ุนูู] ๐ข      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```
- ุฎูููุฉ ุฎุถุฑุงุก
- ูุต ุฃุฎุถุฑ

**ููู ุฅุฌุงุฒุฉ**:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ููุญุฉ ุงูุชุญูู [ุงูููู ุฅุฌุงุฒุฉ] ๐ก           โ
โ ุขุฎุฑ ุชุญุฏูุซ: ุงูุขู โข ุฅุฌุงุฒุฉ ุฃุณุจูุนูุฉ (ุงูุฌูุนุฉ) โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```
- ุฎูููุฉ ููุฑูุงููุฉ
- ูุต ููุฑูุงูู
- ูุนูููุงุช ุฅุถุงููุฉ ุชุนุฑุถ ุงูุณุจุจ

### ุจุทุงูุฉ ุงูุบูุงุจ

**ููู ุนูู**:
- ุงูุนุฏุฏ: ููุญุณุจ ุจุดูู ุทุจูุนู
- ุงููุต: "ูู ูุณุฌู ุงูููู"

**ููู ุฅุฌุงุฒุฉ**:
- ุงูุนุฏุฏ: 0
- ุงููุต: "ูุง ููุญุณุจ ุงูุบูุงุจ ูู ุงูุฅุฌุงุฒุงุช"
- ุงูููู: ุฃุฎุถุฑ (ูุฃู 0 ุฌูุฏ)

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช

### ุชุญุฏูุฏ ุฃูุงู ุงูุฅุฌุงุฒุฉ ุงูุฃุณุจูุนูุฉ

```sql
-- ุชุนููู ุงูุฌูุนุฉ ูุงูุณุจุช ูุฅุฌุงุฒุฉ
UPDATE attendance_calculation_settings
SET weekly_off_days = '{5, 6}'
WHERE company_id = 'ูุนุฑู-ุดุฑูุชู';

-- ุชุนููู ุงูุฃุญุฏ ููุท ูุฅุฌุงุฒุฉ
UPDATE attendance_calculation_settings
SET weekly_off_days = '{0}'
WHERE company_id = 'ูุนุฑู-ุดุฑูุชู';
```

**ูุฑุฌุน ุงูุฃูุงู**:
```
0 = ุงูุฃุญุฏ
1 = ุงูุฅุซููู
2 = ุงูุซูุงุซุงุก
3 = ุงูุฃุฑุจุนุงุก
4 = ุงูุฎููุณ
5 = ุงูุฌูุนุฉ
6 = ุงูุณุจุช
```

### ุฅุถุงูุฉ ุงูุนุทูุงุช

```sql
-- ุฅุถุงูุฉ ุนุทูุฉ ูุงุญุฏุฉ
INSERT INTO holidays (company_id, holiday_date, name)
VALUES ('ูุนุฑู-ุดุฑูุชู', '2026-01-01', 'ุฑุฃุณ ุงูุณูุฉ ุงููููุงุฏูุฉ');

-- ุฅุถุงูุฉ ุนุฏุฉ ุนุทูุงุช
INSERT INTO holidays (company_id, holiday_date, name)
VALUES
  ('ูุนุฑู-ุดุฑูุชู', '2026-01-01', 'ุฑุฃุณ ุงูุณูุฉ ุงููููุงุฏูุฉ'),
  ('ูุนุฑู-ุดุฑูุชู', '2026-09-23', 'ุงูููู ุงููุทูู'),
  ('ูุนุฑู-ุดุฑูุชู', '2026-12-25', 'ุนุทูุฉ ุงูุดุชุงุก');
```

### ุนุฑุถ ุงูุฅุนุฏุงุฏุงุช ุงูุญุงููุฉ

```sql
SELECT
  c.name as ุงูุดุฑูุฉ,
  acs.weekly_off_days as ุฃูุงู_ุงูุฅุฌุงุฒุฉ_ุงูุฃุณุจูุนูุฉ,
  array_agg(h.name) as ุงูุนุทูุงุช_ูุฐุง_ุงูุดูุฑ
FROM companies c
JOIN attendance_calculation_settings acs ON acs.company_id = c.id
LEFT JOIN holidays h ON h.company_id = c.id
  AND EXTRACT(MONTH FROM h.holiday_date) = EXTRACT(MONTH FROM CURRENT_DATE)
WHERE c.status = 'active'
GROUP BY c.id, c.name, acs.weekly_off_days;
```

---

## ๐งช ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### ุงูุณููุงุฑูู 1: ููู ุนูู ุนุงุฏู

```
ุงูุฅุนุฏุงุฏ:
- ุงูููู: ุงูุฅุซููู
- ุฃูุงู ุงูุฅุฌุงุฒุฉ ุงูุฃุณุจูุนูุฉ: ุงูุฌูุนุฉ ูุงูุณุจุช
- ูุง ุชูุฌุฏ ุนุทูุงุช

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
- ุญุงูุฉ ุงูููู: ููู ุนูู
- ุงูุดุงุฑุฉ: "ููู ุนูู" (ุฃุฎุถุฑ)
- ุนุฏุฏ ุงูุบูุงุจ: ููุญุณุจ ุจุดูู ุทุจูุนู
- ูุต ุจุทุงูุฉ ุงูุบูุงุจ: "ูู ูุณุฌู ุงูููู"
```

### ุงูุณููุงุฑูู 2: ุฅุฌุงุฒุฉ ุฃุณุจูุนูุฉ

```
ุงูุฅุนุฏุงุฏ:
- ุงูููู: ุงูุฌูุนุฉ
- ุฃูุงู ุงูุฅุฌุงุฒุฉ ุงูุฃุณุจูุนูุฉ: ุงูุฌูุนุฉ ูุงูุณุจุช
- ูุง ุชูุฌุฏ ุนุทูุงุช

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
- ุญุงูุฉ ุงูููู: ุฅุฌุงุฒุฉ
- ุงูุณุจุจ: ุฅุฌุงุฒุฉ ุฃุณุจูุนูุฉ
- ุงูุชูุงุตูู: "Friday"
- ุงูุดุงุฑุฉ: "ุงูููู ุฅุฌุงุฒุฉ" (ููุฑูุงูู)
- ุนุฏุฏ ุงูุบูุงุจ: 0
- ูุต ุจุทุงูุฉ ุงูุบูุงุจ: "ูุง ููุญุณุจ ุงูุบูุงุจ ูู ุงูุฅุฌุงุฒุงุช"
- ุงูุนููุงู ูุนุฑุถ: "ุฅุฌุงุฒุฉ ุฃุณุจูุนูุฉ (Friday)"
```

### ุงูุณููุงุฑูู 3: ุนุทูุฉ ุฑุณููุฉ

```
ุงูุฅุนุฏุงุฏ:
- ุงูููู: 2026-01-01
- ุฃูุงู ุงูุฅุฌุงุฒุฉ ุงูุฃุณุจูุนูุฉ: ุงูุฌูุนุฉ ูุงูุณุจุช
- ุนุทูุฉ: "ุฑุฃุณ ุงูุณูุฉ ุงููููุงุฏูุฉ" ูู 2026-01-01

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
- ุญุงูุฉ ุงูููู: ุฅุฌุงุฒุฉ
- ุงูุณุจุจ: ุนุทูุฉ
- ุงูุชูุงุตูู: "ุฑุฃุณ ุงูุณูุฉ ุงููููุงุฏูุฉ"
- ุงูุดุงุฑุฉ: "ุงูููู ุฅุฌุงุฒุฉ" (ููุฑูุงูู)
- ุนุฏุฏ ุงูุบูุงุจ: 0
- ุงูุนููุงู ูุนุฑุถ: "ุฑุฃุณ ุงูุณูุฉ ุงููููุงุฏูุฉ"
```

### ุงูุณููุงุฑูู 4: ุดุฑูุงุช ูุชุนุฏุฏุฉ ุจุฅุฌุงุฒุงุช ูุฎุชููุฉ

```
ุงูุฅุนุฏุงุฏ:
- ุงูุดุฑูุฉ ุฃ: ุฅุฌุงุฒุฉ ุฃุณุจูุนูุฉ = ุงูุฌูุนุฉ ููุท
- ุงูุดุฑูุฉ ุจ: ุฅุฌุงุฒุฉ ุฃุณุจูุนูุฉ = ุงูุณุจุช ููุท
- ุงูููู: ุงูุฌูุนุฉ

ุงููุชูุฌุฉ ุงููุชููุนุฉ:

ุงูุดุฑูุฉ ุฃ:
- ุญุงูุฉ ุงูููู: ุฅุฌุงุฒุฉ
- ุงูุดุงุฑุฉ: "ุงูููู ุฅุฌุงุฒุฉ"
- ุงูุบูุงุจ: 0

ุงูุดุฑูุฉ ุจ:
- ุญุงูุฉ ุงูููู: ููู ุนูู
- ุงูุดุงุฑุฉ: "ููู ุนูู"
- ุงูุบูุงุจ: ููุญุณุจ ุจุดูู ุทุจูุนู
```

---

## ๐ ุงูุฃูุงู

### ุนุฒู ุงูุดุฑูุงุช

- โ ูู ุงุณุชุนูุงู ูููุชุฑ ุญุณุจ ูุนุฑู ุงูุดุฑูุฉ
- โ ูุง ูููู ููุดุฑูุฉ A ุฑุคูุฉ ุนุทูุงุช ุงูุดุฑูุฉ B
- โ ุฅุนุฏุงุฏุงุช ูููุตูุฉ ููู ุดุฑูุฉ
- โ ุณูุงุณุงุช RLS ูุงููุฉ ุนูู ุฌุฏูู ุงูุนุทูุงุช

### ุงูุฃุฏุงุก

- ุฒูู ุงูุงุณุชุนูุงู: ุฃูู ูู 10 ูููู ุซุงููุฉ
- ุชุฃุซูุฑ ุนูู ููุญุฉ ุงูุชุญูู: ูุง ููุฐูุฑ
- ูุนูู ุจููุงุกุฉ ูุน 1000+ ุดุฑูุฉ

---

## ๐ ุญู ุงููุดุงูู

### ุงููุดููุฉ 1: ุงูุดุงุฑุฉ ูุง ุชุธูุฑ

**ุงูุชุญูู**:
```javascript
// ูู console ุงููุชุตูุญ
const { data } = await supabase.rpc('get_today_status', {
  p_company_id: 'ูุนุฑู-ุดุฑูุชู',
  p_check_date: new Date().toISOString().split('T')[0]
});
console.log('ุญุงูุฉ ุงูููู:', data);
```

### ุงููุดููุฉ 2: ุนุฏุฏ ุงูุบูุงุจ ููุณ 0 ูู ุงูุฅุฌุงุฒุฉ

**ุงูุชุญูู**:
```sql
-- ุชุญูู ูู ุญุงูุฉ ุงูููู
SELECT get_today_status('ูุนุฑู-ุดุฑูุชู');

-- ุชุญูู ูู ุฃูุงู ุงูุฅุฌุงุฒุฉ ุงูุฃุณุจูุนูุฉ
SELECT weekly_off_days
FROM attendance_calculation_settings
WHERE company_id = 'ูุนุฑู-ุดุฑูุชู';

-- ุชุญูู ูู ุงูุนุทูุงุช ุงูููู
SELECT * FROM holidays
WHERE company_id = 'ูุนุฑู-ุดุฑูุชู'
  AND holiday_date = CURRENT_DATE;
```

### ุงููุดููุฉ 3: ููู ุนูู ูุธูุฑ ูุฅุฌุงุฒุฉ

**ุงูุชุญูู**:
```sql
-- ุชุญูู ูู ุฑูู ููู ุงูุฃุณุจูุน
SELECT EXTRACT(DOW FROM CURRENT_DATE) as ุงูููู;

-- ุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช
SELECT weekly_off_days
FROM attendance_calculation_settings
WHERE company_id = 'ูุนุฑู-ุดุฑูุชู';

-- ุชุญูู ูู ุงูุนุทูุงุช ุงููุฑูุจุฉ
SELECT * FROM holidays
WHERE company_id = 'ูุนุฑู-ุดุฑูุชู'
  AND holiday_date BETWEEN CURRENT_DATE - INTERVAL '7 days'
  AND CURRENT_DATE + INTERVAL '7 days';
```

---

## ๐ ุงูููุงุฆุฏ

### 1. ูุถูุญ ุชุงู
ูุง ูุฒูุฏ ูู ุงูุงุฑุชุจุงู - ุงููุณุชุฎุฏููู ูููููู ููุฑุงู ููุงุฐุง ุงูุนุฏุฏ ุตูุฑ

### 2. ุนุฏุงูุฉ
ูุง ูุชู ุงุญุชุณุงุจ ุบูุงุจ ูู ุฃูุงู ุงูุฅุฌุงุฒุงุช ุงูุฑุณููุฉ

### 3. ูุฑููุฉ
ูู ุดุฑูุฉ ุชุญุฏุฏ ุฅุฌุงุฒุงุชูุง ุงูุฎุงุตุฉ

### 4. ุฏูุฉ ุงูุชูุงุฑูุฑ
ุงูุชูุงุฑูุฑ ุชุนูุณ ุงููุงูุน ุจุฏูู ุญุณุงุจุงุช ุฎุงุทุฆุฉ

### 5. ุณูููุฉ ุงูุฅุฏุงุฑุฉ
ุฅุถุงูุฉ ูุฅุฏุงุฑุฉ ุงูุนุทูุงุช ุจุณูุทุฉ ูุณุฑูุนุฉ

---

## ๐ ุงููููุงุช

### ูููุงุช ุฌุฏูุฏุฉ
1. `supabase/migrations/add_day_status_workday_offday_system.sql` - ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. `test-day-status-offday-system.mjs` - ุงุฎุชุจุงุฑ ุงููุธุงู
3. `DAY_STATUS_OFFDAY_SYSTEM.md` - ุชูุซูู ุดุงูู (ุจุงูุฅูุฌููุฒูุฉ)

### ูููุงุช ูุนุฏููุฉ
1. `src/pages/Dashboard.tsx` - ุฅุถุงูุฉ ุงูุดุงุฑุฉ ูุงูููุทู

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ุจุนุฏ ุงููุดุฑ

1. **ุชุนููู ุฃูุงู ุงูุฅุฌุงุฒุฉ ุงูุฃุณุจูุนูุฉ**:
   - ูู ุจุชุญุฏูุซ `weekly_off_days` ูุดุฑูุชู
   - ูุซุงู: `[5, 6]` ููุฌูุนุฉ ูุงูุณุจุช

2. **ุฅุถุงูุฉ ุงูุนุทูุงุช ุงูุฑุณููุฉ**:
   - ุฃุถู ุฌููุน ุงูุนุทูุงุช ุงูุฑุณููุฉ ููุฐุง ุงูุนุงู
   - ุงุณุชุฎุฏู ุงุณุชุนูุงู INSERT ุงูููุถุญ ุฃุนูุงู

3. **ุงูุชุญูู**:
   - ุงูุชุญ ููุญุฉ ุงูุชุญูู
   - ุชุญูู ูู ุธููุฑ ุงูุดุงุฑุฉ ุจุดูู ุตุญูุญ
   - ุชุฃูุฏ ูู ุฃู ุนุฏุฏ ุงูุบูุงุจ = 0 ูู ุงูุฅุฌุงุฒุงุช

### ุงุฎุชุจุงุฑ ุณุฑูุน

```
1. ุงูุชุญ ููุญุฉ ุงูุชุญูู
2. ุงุจุญุซ ุนู ุงูุดุงุฑุฉ ุจุฌุงูุจ "ููุญุฉ ุงูุชุญูู โ ููุฎุต ุงูููู"
3. ุชุญูู ูู ุงูููู ูุงููุต:
   - ุฃุฎุถุฑ = ููู ุนูู โ
   - ููุฑูุงูู = ุฅุฌุงุฒุฉ โ
4. ูู ููู ุฅุฌุงุฒุฉุ ุชุฃูุฏ:
   - ุนุฏุฏ ุงูุบูุงุจ = 0 โ
   - ุงููุต = "ูุง ููุญุณุจ ุงูุบูุงุจ ูู ุงูุฅุฌุงุฒุงุช" โ
```

---

## โ ุงูุฎูุงุตุฉ

| ุงููููู | ุงูุญุงูุฉ |
|--------|--------|
| ูุงุนุฏุฉ ุงูุจูุงูุงุช | โ ุฌุงูุฒ |
| ูุงุฌูุฉ ุงููุณุชุฎุฏู | โ ุฌุงูุฒ |
| ุงูุงุฎุชุจุงุฑุงุช | โ ูุฌุญุช |
| ุงูุจูุงุก | โ ุจุฏูู ุฃุฎุทุงุก |
| ุงูุชูุซูู | โ ุดุงูู |

**ุชุงุฑูุฎ ุงูุชูููุฐ**: 2026-02-02
**ุงูุญุงูุฉ**: โ **ููุชูู ูุฌุงูุฒ ููุฅูุชุงุฌ**

---

## ๐ ููุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุฑุงุฌุน ูุณู "ุญู ุงููุดุงูู" ุฃุนูุงู
2. ุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช ุจุงุณุชุฎุฏุงู ุงูุงุณุชุนูุงูุงุช ุงููุฐููุฑุฉ
3. ุชุฃูุฏ ูู ุฃู ุฌุฏูู `holidays` ู `attendance_calculation_settings` ููุฌูุฏุงู

**ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูููุฑู!** ๐
