# ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุฉ ููููุงุชู ุงููุญูููุฉ

## ๐ฑ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทุจูู ูุธุงู ุฅุดุนุงุฑุงุช ููุญูุฏ ูุฃุฌูุฒุฉ **Android** ู **iOS** ุจุงุณุชุฎุฏุงู Capacitor ูFirebase Cloud Messaging.

## โ ุงูููุฒุงุช ุงูููุฌุฒุฉ

- โ ูุธุงู ููุญุฏ: ููุฏ ูุงุญุฏ ูู Android ู iOS
- โ ุชุชุจุน ุงูุฃุฌูุฒุฉ: ูุนุฑูู ูุฑูุฏ ููู ุฌูุงุฒ
- โ Multi-Tenant: ุนุฒู ุจูู ุงูุดุฑูุงุช
- โ ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช: ูุง ุชูุฌุฏ ุทูุจุงุช ุชููุงุฆูุฉ
- โ ููุญุฉ ุงููุฏูุฑ: ุชูุนูู/ุชุนุทูู + ุฅุฑุณุงู ุชุฌุฑูุจู
- โ ูุงุนุฏุฉ ุงูุจูุงูุงุช: ุฌุฏูู `push_devices`

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูููุณุชุฎุฏู ุงูููุงุฆู (Admin)

1. **ูุชุญ ุงูุฅุนุฏุงุฏุงุช**
   - ุงูุชูู ุฅูู ุงูุฅุนุฏุงุฏุงุช (Settings)
   - ุงุฐูุจ ููุณู "ุงูุฅุดุนุงุฑุงุช"

2. **ุชูุนูู ุงูุฅุดุนุงุฑุงุช**
   - ุงุถุบุท ุนูู "ุชูุนูู ุงูุฅุดุนุงุฑุงุช"
   - ุงุณูุญ ุจุงูุฅุฐู ุนูุฏ ุทูุจ ุงููุธุงู
   - ุณุชุฑู "โ ุงูุฅุดุนุงุฑุงุช ููุนููุฉ"

3. **ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช**
   - ุงุถุบุท "ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู"
   - ูุฌุจ ุฃู ุชุณุชูู ุฅุดุนุงุฑุงู ููุฑูุงู

### ูููุทููุฑ

#### Android (Windows/Mac/Linux)

```bash
# 1. ุฅุถุงูุฉ ููุตุฉ Android
npx cap add android

# 2. ุจูุงุก ููุฒุงููุฉ
npm run build
npx cap sync android

# 3. ูุชุญ ูู Android Studio
npx cap open android

# ุฃู ุงุณุชุฎุฏู ุงูุฃูุฑ ุงููุฎุชุตุฑ
npm run cap:android
```

**ูุชุทูุจุงุช**:
- Firebase project
- ููู `google-services.json` ูู `android/app/`

**ุฏููู ูุงูู**: [android-push-setup.md](./android-push-setup.md)

#### iOS (Mac ููุท)

```bash
# 1. ุฅุถุงูุฉ ููุตุฉ iOS
npx cap add ios

# 2. ุจูุงุก ููุฒุงููุฉ
npm run build
npx cap sync ios

# 3. ูุชุญ ูู Xcode
npx cap open ios

# ุฃู ุงุณุชุฎุฏู ุงูุฃูุฑ ุงููุฎุชุตุฑ
npm run cap:ios
```

**ูุชุทูุจุงุช**:
- ุญุณุงุจ Apple Developer
- APNs Key (.p8 file)
- Xcode 14 ุฃู ุฃุญุฏุซ

**ุฏููู ูุงูู**: [ios-push-setup.md](./ios-push-setup.md)

## ๐๏ธ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู `push_devices`

```sql
{
  id: uuid
  company_id: uuid          -- ุนุฒู ุจูู ุงูุดุฑูุงุช
  user_id: uuid            -- ุตุงุญุจ ุงูุฌูุงุฒ
  device_id: text          -- ูุนุฑูู ูุฑูุฏ ููุฌูุงุฒ
  platform: text           -- android | ios | web
  token: text              -- FCM/APNs token
  enabled: boolean         -- ููุนูู/ูุนุทูู
  last_seen_at: timestamp
}
```

### RLS Policies

- โ ุงููุณุชุฎุฏููู ูุฑูู ุฃุฌูุฒุชูู ููุท
- โ ุนุฒู ุชุงู ุจูู ุงูุดุฑูุงุช
- โ ุชุนุทูู ุชููุงุฆู ุนูุฏ ุชุณุฌูู ุงูุฎุฑูุฌ

## ๐ ูููู ุงููููุงุช

```
src/utils/pushNotifications.ts      โ ุงูููุทู ุงูุฃุณุงุณู
src/pages/Settings.tsx              โ ูุงุฌูุฉ ุงููุณุชุฎุฏู
capacitor.config.ts                 โ ุฅุนุฏุงุฏุงุช Capacitor
android/                            โ ููุตุฉ Android
ios/                                โ ููุตุฉ iOS
```

## ๐ ุงูุฏูุงู ุงูุฑุฆูุณูุฉ

```typescript
// ุทูุจ ุงูุตูุงุญูุฉ (ุนูุฏ ุถุบุท ุงููุณุชุฎุฏู)
await requestNativePushPermission(userId, 'admin')

// ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู
await sendTestPushNotification(userId)

// ุชุนุทูู ุนูุฏ ุชุณุฌูู ุงูุฎุฑูุฌ
await unregisterPushNotifications(userId)
```

## ๐งช ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

1. โ ุฅูุดุงุก Firebase project
2. โ ุชุญููู google-services.json (Android)
3. โ ุฅูุดุงุก APNs key (iOS)
4. โ ุฅุถุงูุฉ ุงูููุตุฉ: `npx cap add android/ios`
5. โ ุงูุจูุงุก ูุงููุฒุงููุฉ: `npm run build && npx cap sync`
6. โ ุงูุชุดุบูู ุนูู ุฌูุงุฒ ุญูููู
7. โ ููุญ ุงูุตูุงุญูุฉ
8. โ ุงูุชุญูู ูู ุญูุธ token ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
9. โ ุฅุฑุณุงู ูุงุณุชูุงู ุฅุดุนุงุฑ ุชุฌุฑูุจู

## ๐ฑ ุงุฎุชุจุงุฑ ูุชุนุฏุฏ ุงูุฃุฌูุฒุฉ

- ูููู ุชูุนูู ุงูุฅุดุนุงุฑุงุช ุนูู ุนุฏุฉ ุฃุฌูุฒุฉ ูููุณ ุงููุณุชุฎุฏู
- ูู ุฌูุงุฒ ูู `device_id` ูุฑูุฏ
- ุงูุฅุดุนุงุฑ ุงูุชุฌุฑูุจู ููุฑุณู ููุฌูุงุฒ ุงูุฃุฎูุฑ
- ุงูุฅุดุนุงุฑุงุช ุงูุญููููุฉ ุชูุฑุณู ูุฌููุน ุงูุฃุฌูุฒุฉ ุงูููุนููุฉ

## ๐ง ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### "Capacitor not defined"
โ ูุฌุจ ุงูุชุดุบูู ุนูู Android Studio ุฃู Xcode ูููุณ ุงููุชุตูุญ

### ุชู ุฑูุถ ุงูุตูุงุญูุฉ
โ ูุฌุจ ุนูู ุงููุณุชุฎุฏู ุชูุนูููุง ูู ุฅุนุฏุงุฏุงุช ุงููุธุงู ูุฏููุงู

### Token ุบูุฑ ูุญููุธ
โ ุชุญูู ูู RLS policies ูู Supabase

### ูู ูุตู ุงูุฅุดุนุงุฑ
โ ุชุญูู ูู ูุฌูุฏ token ูู ุฌุฏูู push_devices

## ๐ ุงูุฃุฏูุฉ ุงููุงููุฉ

- **ุงูุฏููู ุงูุดุงูู**: [NATIVE_PUSH_NOTIFICATIONS_GUIDE.md](./NATIVE_PUSH_NOTIFICATIONS_GUIDE.md)
- **ุฏููู Android**: [android-push-setup.md](./android-push-setup.md)
- **ุฏููู iOS**: [ios-push-setup.md](./ios-push-setup.md)
- **ุงูุจุฏุก ุงูุณุฑูุน**: [QUICK_START_NATIVE_PUSH.md](./QUICK_START_NATIVE_PUSH.md)

## โก ุงูุฃูุงูุฑ ุงููุฎุชุตุฑุฉ

```bash
# ุจูุงุก ุงูุชุทุจูู
npm run build

# ูุฒุงููุฉ ุงูุชุบููุฑุงุช ูุน ุงูููุตุงุช
npm run cap:sync

# ูุชุญ Android Studio
npm run cap:android

# ูุชุญ Xcode (Mac ููุท)
npm run cap:ios
```

## ๐ฏ ุงูููุฎุต

โ **ุงูุญุงูุฉ**: ุฌุงูุฒ ููุงุณุชุฎุฏุงู
โ **ุงูููุตุงุช**: Android โ | iOS โ
โ **ูุงุนุฏุฉ ุงูุจูุงูุงุช**: ููุชููุฉ
โ **ุงููุงุฌูุฉ**: ููุชููุฉ
โ **ุงูุชูุซูู**: ููุชูู

**ุงูุฎุทูุฉ ุงูุชุงููุฉ**: ุงุชุจุน ุฏููู ุงูููุตุฉ (Android ุฃู iOS) ูุชุฌุฑุจุฉ ุงููุธุงู ุนูู ุฌูุงุฒ ุญูููู!

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ**: 1 ูุจุฑุงูุฑ 2026
**ุงูุฅุตุฏุงุฑ**: 1.0.0
